---
title: "Final Project Report"
author: "Abbie Benfield, Annah Mutaya"
date: "5/6/2022"
output:
  html_document: default
---

# Introduction

```{r, message = FALSE}
library(tidyverse)
library(janitor)
library(skimr)
library(corrplot)
library(gbm)
library(e1071)

spotify_full <- read_csv("spotify_dataset.csv") %>%
  clean_names() %>%
  mutate(top_20 = ifelse(highest_charting_position <= 20, TRUE, FALSE))

head(spotify_full)
```

# Exploratory Data Analysis

```{r}
skim(spotify_full)
```

```{r}
ggplot(spotify_full, aes(x = highest_charting_position)) +
  geom_freqpoly(bins = 30) +
  labs(x = "Highest Charting Postion", y = "Count", title = "Distribution of Highest Charting Position")
```

```{r}
# Should we remove duplicate song IDs?
spotify_full %>%
  group_by(song_id) %>%
  count() %>%
  filter(n > 1)
```


```{r}
clean <- spotify_full %>%
  na.omit() %>%
  select(-index, -song_id, -weeks_charted, -week_of_highest_charting, -genre, 
         -release_date, -chord, -song_name, -artist, -highest_charting_position)

skim(clean)
```


```{r}
corrplot(cor(clean), method = "circle", tl.col = "black", tl.srt = 45, type = "upper")
```


# Methodology

```{r}
set.seed(1)

te <- clean %>% 
  sample_n(1000)

tr <- clean %>% 
  setdiff(te)

test <- te %>% 
  select(-top_20) %>% 
  scale() %>% 
  data.frame()

test_20 <- te %>% 
  select(top_20) %>% 
  .$top_20
  
train <- tr %>% 
  select(-top_20) %>% 
  scale() %>% 
  data.frame()

train_20 <- tr %>% 
  select(top_20) %>% 
  .$top_20


```

### Logistic

### KNN

### Trees

### SVM?